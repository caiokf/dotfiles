# Load shell configuration
source ~/.shell_env

# Initialize mise (version manager)
if command -v mise &>/dev/null; then
    eval "$(mise activate bash)"
fi

# Initialize Starship prompt
if command -v starship &>/dev/null; then
    eval "$(starship init bash)"
fi

# Source additional files if they exist
for file in ~/.{path,bash_prompt,aliases,functions,extra}; do
    [ -r "$file" ] && [ -f "$file" ] && source "$file"
done
unset file

# Bash options
shopt -s nocaseglob     # Case-insensitive globbing
shopt -s histappend     # Append to history file
shopt -s cdspell        # Autocorrect typos in cd paths

# Enable Bash 4+ features
for option in autocd globstar; do
    shopt -s "$option" 2>/dev/null
done

# Bash completion
if command -v brew &>/dev/null && [ -r "$(brew --prefix)/etc/profile.d/bash_completion.sh" ]; then
    source "$(brew --prefix)/etc/profile.d/bash_completion.sh"
elif [ -f /etc/bash_completion ]; then
    source /etc/bash_completion
fi

# SSH hostname completion
[ -e "$HOME/.ssh/config" ] && complete -o "default" -o "nospace" -W "$(grep "^Host" ~/.ssh/config | grep -v "[?*]" | cut -d " " -f2 | tr ' ' '\n')" scp sftp ssh
